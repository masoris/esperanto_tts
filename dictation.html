<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Voice Input</title>
    <script src="./ajax.js?version3.0"></script>
</head>

<body>
    <h1>Voice Input</h1>
    <table>
        <tr>
            <td>
                <label for="voice">Select a voice:</label>
            </td>
            <td>
                <select id="voice" name="voice">
                    <option value="ludoviko">ludoviko</option>
                    <option value="male1">Male 1</option>
                    <option value="male2">Male 2</option>
                    <option value="male3">Male 3</option>
                    <option value="female1">Female 1</option>
                    <option value="female2">Female 2</option>
                    <option value="female3">Female 3</option>
                </select>
            </td>
        </tr>
        <tr>
            <td valign="top" align="right">
                <label for="eo-org">File name:</label>
            </td>
            <td>
                <textarea id="eo-org" name="eo-org" rows="3" cols="30"></textarea>
            </td>
        </tr>
        <tr>
            <td valign="top" align="right">
                <label for="eo">Eo:</label>
            </td>
            <td>
                <textarea id="eo" name="eo" rows="3" cols="30"></textarea>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <button onclick="speak('eo')">Speak</button>
            </td>
        </tr>
        <tr>
            <td valign="top" align="right">
                <label for="pl">Pl:</label>
            </td>
            <td>
                <textarea id="pl" name="pl" rows="3" cols="30"></textarea>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <button onclick="speak('pl')">Speak</button>
                <button onclick="remember()">Remember</button>
                <button id="remember_all" onclick="remember_all()">Remember All</button>
                <button onclick="remove_all()">Remove All</button>
            </td>

        </tr>
    </table>



    <a id="download-link" href="./output.mp3" download>Download Audio</a>

    ą ć ę ł ń ó ś ź ż


    <script>
        document.getElementById("voice").onchange = function () {
        }
        function speak(field) {
            if (document.getElementById("eo-org").value == "" && field == "eo") {
                document.getElementById("eo-org").value = document.getElementById("eo").value;
            }
            voice = document.getElementById("voice").value;
            text = document.getElementById(field).value;
            jsonObj = { lang: field, voicename: voice, textdata: text };
            strdata = JSON.stringify(jsonObj);
            postAjaxRequest('/tts/speak.api', strdata, function (response) {
                jsonObj = JSON.parse(response);
                document.getElementById('pl').value = jsonObj.pol_txt;
                if (jsonObj.esp_txt != null) {
                    document.getElementById('eo').value = jsonObj.esp_txt;
                }
                audio = new Audio();
                nowInMillis = new Date().getTime();
                audio.src = './output.mp3?' + nowInMillis;
                audio.play();
            }, function (errcode) { });
        }

        function remember_all() {
            if (document.getElementById("eo-org").value == "") {
                document.getElementById("eo-org").value = document.getElementById("eo").value;
            }
            const eo_txt = document.getElementById("eo").value;
            const pl_txt = document.getElementById("pl").value;
            const filename = document.getElementById("eo-org").value;
            jsonObj = { eo_txt: eo_txt, pl_txt: pl_txt, filename: filename };
            strdata = JSON.stringify(jsonObj);
            document.getElementById("remember_all").disabled = true;
            postAjaxRequest('/tts/remember_all.api', strdata, function (response) {
                jsonObj = JSON.parse(response);
                document.getElementById("remember_all").disabled = false;
            }, function (errcode) { });
        }

        function remove_all() {
            if (document.getElementById("eo-org").value == "") {
                document.getElementById("eo-org").value = document.getElementById("eo").value;
            }
            const eo_txt = document.getElementById("eo").value;
            const pl_txt = document.getElementById("pl").value;
            const filename = document.getElementById("eo-org").value;
            jsonObj = { eo_txt: eo_txt, pl_txt: pl_txt, filename: filename };
            strdata = JSON.stringify(jsonObj);
            postAjaxRequest('/tts/remove_all.api', strdata, function (response) {
                jsonObj = JSON.parse(response);
            }, function (errcode) { });
        }

        function remember() {
            if (document.getElementById("eo-org").value == "") {
                document.getElementById("eo-org").value = document.getElementById("eo").value;
            }
            const eo_txt = document.getElementById("eo").value;
            const pl_txt = document.getElementById("pl").value;
            const voice = document.getElementById("voice").value;
            const filename = document.getElementById("eo-org").value;
            jsonObj = { eo_txt: eo_txt, pl_txt: pl_txt, voice_name: voice, filename: filename };
            strdata = JSON.stringify(jsonObj);
            postAjaxRequest('/tts/remember.api', strdata, function (response) {
                jsonObj = JSON.parse(response);
            }, function (errcode) { });
        }
    </script>
</body>

</html>